clear all;
close all;

Fs = 1000;                    % Sampling frequency
T = 1/Fs;                     % Sampling period
L = 64;                     % Length of signal
t = (0:L-1)*T;                % Time vector

%x1 = cos(2*pi*50*t);          % First row wave

n = 2^nextpow2(L);

x_chosen = [1,0.951056516295154,0.809016994374948,0.587785252292473,0.309016994374947,6.12323399573677e-17,-0.309016994374948,-0.587785252292473,-0.809016994374947,-0.951056516295154,-1,-0.951056516295154,-0.809016994374947,-0.587785252292473,-0.309016994374948,-1.83697019872103e-16,0.309016994374947,0.587785252292474,0.809016994374948,0.951056516295154,1,0.951056516295153,0.809016994374948,0.587785252292473,0.309016994374947,-5.82016719913287e-16,-0.309016994374949,-0.587785252292473,-0.809016994374947,-0.951056516295153,-1,-0.951056516295154,-0.809016994374948,-0.587785252292472,-0.309016994374946,1.34773045969868e-15,0.309016994374949,0.587785252292473,0.809016994374947,0.951056516295153,1,0.951056516295153,0.809016994374947,0.587785252292472,0.309016994374948,5.51091059616309e-16,-0.309016994374947,-0.587785252292473,-0.809016994374948,-0.951056516295154,-1,-0.951056516295153,-0.809016994374946,-0.587785252292472,-0.309016994374948,1.10280109986921e-15,0.309016994374947,0.587785252292474,0.809016994374947,0.951056516295154,1,0.951056516295153,0.809016994374948,0.587785252292472];
x_calculated = [1.0000+0.0000i,0.9511-0.0000i,0.8090+0.0000i,0.5878+0.0000i,0.3090+0.0000i,-0.0000+0.0000i,-0.3090+0.0000i,-0.5878+0.0000i,-0.8090+0.0000i,-0.9511-0.0000i,-1.0000-0.0000i,-0.9511+0.0000i,-0.8090+0.0000i,-0.5878-0.0000i,-0.3090-0.0000i,-0.0000+0.0000i,0.3090-0.0000i,0.5878-0.0000i,0.8090+0.0000i,0.9511+0.0000i,1.0000-0.0000i,0.9511-0.0000i,0.8090+0.0000i,0.5878-0.0000i,0.3090+0.0000i,0.0000+0.0000i,-0.3090+0.0000i,-0.5878+0.0000i,-0.8090+0.0000i,-0.9511-0.0000i,-1.0000-0.0000i,-0.9511+0.0000i,-0.8090+0.0000i,-0.5878+0.0000i,-0.3090+0.0000i,0.0000+0.0000i,0.3090+0.0000i,0.5878-0.0000i,0.8090+0.0000i,0.9511-0.0000i,1.0000-0.0000i,0.9511+0.0000i,0.8090-0.0000i,0.5878-0.0000i,0.3090-0.0000i,0.0000+0.0000i,-0.3090-0.0000i,-0.5878+0.0000i,-0.8090+0.0000i,-0.9511+0.0000i,-1.0000-0.0000i,-0.9511-0.0000i,-0.8090+0.0000i,-0.5878+0.0000i,-0.3090+0.0000i,0.0000-0.0000i,0.3090-0.0000i,0.5878-0.0000i,0.8090-0.0000i,0.9511-0.0000i,1.0000-0.0000i,0.9511-0.0000i,0.8090+0.0000i,0.5878-0.0000i];


Y = fft(x_chosen);

x_matlab = ifft(Y);

plot(t,x_chosen, t, x_matlab, t, x_calculated)
legend('Signal','iFFT Matlab' ,'iFFT RISCV-V')
title("iFFT Comparison | err-risc = " + norm(x_calculated-x_chosen) + "| err-matlab = " + norm(x_matlab-x_chosen))

Y_u = [3.3479+0.0000i,3.6755+0.7674i,5.2884+2.2672i,25.3201+17.0452i,-5.0615-4.8649i,-1.7800-2.3557i,-0.8833-1.6051i,-0.4798-1.2310i,-0.2569-1.0014i,-0.1186-0.8434i,-0.0261-0.7264i,0.0391-0.6352i,0.0870-0.5616i,0.1231-0.5003i,0.1511-0.4482i,0.1732-0.4031i,0.1910-0.3633i,0.2054-0.3277i,0.2173-0.2956i,0.2271-0.2663i,0.2353-0.2393i,0.2422-0.2142i,0.2480-0.1907i,0.2528-0.1684i,0.2569-0.1473i,0.2603-0.1271i,0.2631-0.1077i,0.2653-0.0889i,0.2671-0.0705i,0.2685-0.0526i,0.2694-0.0349i,0.2700-0.0174i,0.2702+0.0000i,0.2700+0.0174i,0.2694+0.0349i,0.2685+0.0526i,0.2671+0.0705i,0.2653+0.0889i,0.2631+0.1077i,0.2603+0.1271i,0.2569+0.1473i,0.2528+0.1684i,0.2480+0.1907i,0.2422+0.2142i,0.2353+0.2393i,0.2271+0.2663i,0.2173+0.2956i,0.2054+0.3277i,0.1910+0.3633i,0.1732+0.4031i,0.1511+0.4482i,0.1231+0.5003i,0.0870+0.5616i,0.0391+0.6352i,-0.0261+0.7264i,-0.1186+0.8434i,-0.2569+1.0014i,-0.4798+1.2310i,-0.8833+1.6051i,-1.7800+2.3557i,-5.0615+4.8649i,25.3201-17.0452i,5.2884-2.2672i,3.6755-0.7674i];

figure;
P2 = abs(Y/L);
P1 = P2(:,1:n/2+1);
P1(:,2:end-1) = 2*P1(:,2:end-1);

P4 = abs(Y_u/L);
P3 = P4(:,1:n/2+1);
P3(:,2:end-1) = 2*P3(:,2:end-1);

plot(0:(Fs/n):(Fs/2-Fs/n),P1(1:n/2), 0:(Fs/n):(Fs/2-Fs/n), P3(1:n/2))
legend('FFT Matlab','FFT RISCV-V')
title("FFT Comparison | err = " + norm(Y_u-Y))